{{ define "main" }}
    <h1 class="content-header">{{ .Title }}</h1>
    <section class="content-section content-section--blue">
        <p>{{ .Content }}</p>
    </section>

    {{ range .Pages }}
        <section id="{{ .Section }}">
            {{ .Render "section-info" }}
            <section class="content-section">
                {{ .Content }}
            </section>
        </section>
    {{ end }}

    {{ with .Site.GetPage (printf "/products/%s" .ContentBaseName) }}
        <section id="{{ .Section }}-{{ .ContentBaseName }}-products">
            <h1 class=content-header>{{ .Title }}</h2>
            <section class="content-section content-section--dark">
                {{ .Content }}
            </section>
            <div class="content-section product-list content-info" style="grid-template-rows: repeat({{ len .Pages }}, auto)">
                {{ partial "detail-tiles" (dict "name" "products" "default" 0 "preview-partial" "product-preview" "content-partial" "product-content" "items" .Pages) }}
            </div>
        </section>
    {{ end }}

    <section id="{{ .Section }}-{{ .ContentBaseName }}-projects">
        <h1 class="content-header">{{ .Params.projectsTitle }}</h1>
        {{ if and .Params.projectsSummary .Params.projectsDescription }}
            <section class="content-section content-section--blue content-info">
                <p class="content-summary">{{ .Params.projectsSummary }}</p>
                <p class="content-description">{{ .Params.projectsDescription }}</p>
            </section>
        {{ end }}
        <div class="content-section section-companies section-projects">
            {{ $projects := (.Site.GetPage "projects").Pages }}
            {{ with where $projects "Params.services" "intersect" (slice .File.ContentBaseName) }}
                {{ partial "detail-tiles" (dict "name" "projects" "default" 0 "preview-partial" "company-preview" "content-partial" "company-content" "items" .) }}
            {{ end }}
        </div>
    </section>
{{ end }}
